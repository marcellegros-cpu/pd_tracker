{% extends "base.html" %}

{% block title %}Exercise History - PD Tracker{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Exercise History</h1>
    <div class="header-actions">
        <a href="{{ url_for('exercise') }}" class="btn btn-secondary">Back</a>
    </div>
</div>

<!-- Filters and Stats -->
<section class="card">
    <form method="get" class="filter-form">
        <div class="form-group">
            <label for="days">Days</label>
            <select name="days" id="days" class="form-control" onchange="this.form.submit()">
                <option value="7" {% if days == 7 %}selected{% endif %}>7 days</option>
                <option value="14" {% if days == 14 %}selected{% endif %}>14 days</option>
                <option value="30" {% if days == 30 %}selected{% endif %}>30 days</option>
                <option value="90" {% if days == 90 %}selected{% endif %}>90 days</option>
            </select>
        </div>
    </form>

    {% if stats.total_sessions > 0 %}
    <div class="stats-summary">
        <h3>Summary</h3>
        <div class="stats-row">
            <div class="stat">
                <span class="stat-value">{{ stats.total_sessions }}</span>
                <span class="stat-label">Sessions</span>
            </div>
            <div class="stat">
                <span class="stat-value">{{ stats.total_minutes }}</span>
                <span class="stat-label">Total Minutes</span>
            </div>
            <div class="stat">
                <span class="stat-value">{{ stats.avg_minutes_per_day }}</span>
                <span class="stat-label">Avg/Day</span>
            </div>
        </div>
    </div>
    {% endif %}
</section>

<!-- Exercise List -->
<section class="card">
    <h2>Exercise Logs</h2>
    {% if logs %}
        {% for log in logs %}
        <div class="list-item">
            <div class="list-item-main">
                <strong>{{ log.exercise_type }}</strong>
                <p class="small">{{ log.start_time|dateformat('%a, %b %d at %I:%M %p') }}</p>
                <p class="small">
                    <span class="badge">{{ log.duration_minutes }} min</span>
                    <span class="badge badge-{{ 'success' if log.intensity == 'vigorous' else 'warning' if log.intensity == 'moderate' else 'secondary' }}">
                        {{ log.intensity|capitalize }}
                    </span>
                </p>
                {% if log.notes %}
                    <p class="small muted">{{ log.notes }}</p>
                {% endif %}
            </div>
            <div class="list-item-actions">
                <a href="{{ url_for('exercise_edit', exercise_id=log.id) }}" class="btn btn-small">Edit</a>
                <form action="{{ url_for('exercise_delete', exercise_id=log.id) }}" method="post" class="inline-form" onsubmit="return confirm('Delete this exercise record?');">
                    <button type="submit" class="btn btn-small btn-danger">Delete</button>
                </form>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <p class="muted">No exercise logs found for this period.</p>
    {% endif %}
</section>
{% endblock %}
